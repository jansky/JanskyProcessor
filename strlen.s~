; implementation of strlen function
; pr1 - memory address of string
; ar1 - output - length of string (result is copied to ar2)
cpy l teststring r pr1
jmp l strlen
cpy r ar1 r ar2
put r pr1 0x01
put r pr2 0x01
cpy l teststring r ar1
int 0x10
hlt
lbl strlen
cpy r pr1 r ar1
lbl strlenloop
cmp pr pr1 a 0
jmprc ne l count l strlenloop
sub r pr1 r ar1
cpy r pr1 r ar1
ret
lbl count
add r pr1 a 1
ret
hlt
raws .dta
lbl teststring
raws This is a test of an implementation of the strlen() function on the JanskyProcessor emulator. If all goes according to plan, the number of characters in this string are counted correctly and placed in ar2, and this string is displayed on the screen.
rawb 0x0a
rawb 0x00
